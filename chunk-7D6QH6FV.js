import{a as Q}from"./chunk-U6Z352PU.js";import{B as b,C as U,D as W,E as q,F as z,G,H,I as v,W as J,ca as K,d as g,e as B,o as j,p as R,w as p}from"./chunk-MQVGECFW.js";import{h as $,j as f}from"./chunk-SL3BKGXR.js";import{Bb as a,Db as k,Hb as P,Jb as T,Ka as h,Kb as E,La as u,Lb as n,Lc as D,Mb as s,Nb as c,Qb as N,Ub as w,Vb as y,cb as r,da as F,dc as S,ec as A,fc as O,kb as C,pc as L,qa as m,sc as x,tc as _,ub as l,wb as I,ya as M,za as V}from"./chunk-HLRLCPE5.js";var re=i=>({active:i});function ne(i,Y){if(i&1){let e=N();n(0,"button",8),w("click",function(){let t=M(e).$implicit,d=y();return V(d.control().patchValue(t))}),S(1),x(2,"titlecase"),s()}if(i&2){let e=Y.$implicit,o=y();a("ngClass",L(4,re,o.isActive()(e))),r(),O(" ",_(2,2,o.formatter()(e))," ")}}var X=(()=>{class i{constructor(){this.placeholder=u("Placeholder"),this.control=I(new p(null)),this.items=u([]),this.formatter=u(e=>`${e??""}`),this.isActive=u(()=>!1),this.clearFilterClicked=h(),this.elementSelected=h(),this.selectedValue=l("")}ngOnInit(){this.control().valueChanges.pipe(F(null)).subscribe(e=>{this.selectedValue.set(e?this.formatter()(e):this.placeholder())})}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=C({type:i,selectors:[["app-dropdown"]],inputs:{placeholder:[1,"placeholder"],control:[1,"control"],items:[1,"items"],formatter:[1,"formatter"],isActive:[1,"isActive"]},outputs:{control:"controlChange",clearFilterClicked:"clearFilterClicked",elementSelected:"elementSelected"},decls:11,vars:5,consts:[["ngbDropdown","",1,"d-flex","justify-content-center"],[1,"input-group","flex-nowrap","has-validation"],["type","button","ngbDropdownToggle","",1,"btn","btn-outline-primary","d-flex","justify-content-between","align-items-center","w-100","dropdown"],[1,"dropdown-label"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fa","fa-times"],["ngbDropdownMenu","",1,"w-100"],["ngbDropdownItem","",3,"ngClass"],["ngbDropdownItem","",3,"click","ngClass"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1)(2,"button",2)(3,"span",3),S(4),x(5,"titlecase"),s()(),n(6,"button",4),w("click",function(){return t.control().patchValue(null)}),c(7,"i",5),s(),n(8,"div",6),T(9,ne,3,6,"button",7,P),s()()()),o&2&&(r(3),k("active",t.control().value),r(),A(_(5,3,t.selectedValue())),r(5),E(t.items()))},dependencies:[U,b,v,H,G,z,W,q,f,$],styles:["[_nghost-%COMP%]{display:block;width:100%}.dropdown[_ngcontent-%COMP%]{border-top-right-radius:0;border-bottom-right-radius:0;--bs-btn-color: var(--body-bg);--bs-btn-border-color: var(--bs-border-color);--bs-btn-hover-border-color: var(--bs-border-color)}.dropdown[_ngcontent-%COMP%]   button.btn-outline-primary.show[_ngcontent-%COMP%], .dropdown[_ngcontent-%COMP%]   button.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:transparent;--bs-btn-active-border-color: var(--bs-border-color)}.dropdown-label[_ngcontent-%COMP%]{opacity:.6}.dropdown-label.active[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0})}}return i})();var Me=(()=>{class i{constructor(){this.filtersChanged=h(),this.exerciseLogService=m(j),this.authService=m(K),this.exerciseLogApiService=m(R),this.titleCasePipe=m(f),this.userSelector=e=>e?.name??"",this.exerciseFormatter=e=>this.titleCasePipe.transform(e),this.weightFormatter=e=>isNaN(parseInt(e??""))?"":`${e}kg`,this.exerciseSelector=e=>typeof e=="string"?"":this.titleCasePipe.transform(e?.name)??"",this.userControl=new p(null),this.typeControl=new p(null),this.exerciseControl=new p(null),this.weightControl=new p(null),this.userControlValues=g(this.userControl.valueChanges),this.typeControlValues=g(this.typeControl.valueChanges),this.exerciseControlValues=g(this.exerciseControl.valueChanges),this.weightControlValues=g(this.weightControl.valueChanges),this.users=l([]),this.types=l([]),this.weights=l([]),this.exercises=l([]),this.filters=B({loader:()=>this.exerciseLogApiService.getFilters(this.userControl.value?.userId,this.exerciseControl.value?.exerciseId,this.typeControl.value,this.weightControl.value?+this.weightControl.value:null)}),this.#e=D(()=>{let e=this.filters.value(),o=this.authService.user();e&&(this.users.set([o,...o?.assignedUsers??[]]),this.types.set(e.types),this.weights.set(e.weights.map(t=>`${t}`)),this.exercises.set(this.exerciseLogService.exercises().filter(t=>e.exercisesIds.includes(t.exerciseId))))}),this.#t=D(()=>{let e=this.userControlValues(),o=this.typeControlValues(),t=this.exerciseControlValues(),d=this.weightControlValues(),Z=e?[e.userId]:[],ee=o?[o]:[],te=t?.exerciseId?[t.exerciseId]:[],oe=d?[+d]:[];this.filters.reload(),this.filtersChanged.emit({userId:Z,exercisesIds:te,types:ee,weights:oe})})}#e;#t;static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=C({type:i,selectors:[["app-filters"]],outputs:{filtersChanged:"filtersChanged"},decls:10,vars:11,consts:[[1,"container"],[1,"col-12","mb-2"],["placeholder","User",3,"control","items","itemSelector"],[1,"row","mb-2","gx-2"],[1,"col-12"],["placeholder","Type",3,"control","items"],["placeholder","Exercise",3,"control","items","itemSelector"],["placeholder","Weight (kg)",3,"control","items","itemSelector"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1),c(2,"app-typeahead",2),s(),n(3,"div",3)(4,"div",4),c(5,"app-dropdown",5),s()(),n(6,"div",1),c(7,"app-typeahead",6),s(),n(8,"div",1),c(9,"app-typeahead",7),s()()),o&2&&(r(2),a("control",t.userControl)("items",t.users())("itemSelector",t.userSelector),r(3),a("control",t.typeControl)("items",t.types()),r(2),a("control",t.exerciseControl)("items",t.exercises())("itemSelector",t.exerciseSelector),r(2),a("control",t.weightControl)("items",t.weights())("itemSelector",t.weightFormatter))},dependencies:[J,b,v,Q,X],styles:[".dropdown-item{background-color:var(--light-bg)}"],changeDetection:0})}}return i})();export{Me as a};
