import{a as G}from"./chunk-ZPFUEYMJ.js";import{a as K}from"./chunk-HVNXOSLQ.js";import{a as q}from"./chunk-DPMLOELO.js";import"./chunk-EUTS36DN.js";import"./chunk-JWGIT43Z.js";import{a as $}from"./chunk-J5MRFX3I.js";import{a as _}from"./chunk-O27UE7TO.js";import"./chunk-DIR3HG3V.js";import{q as U,t as z}from"./chunk-F4UEUSBD.js";import{Ad as B,Bb as E,Db as x,Ka as l,Kc as W,Nb as b,Ob as N,Rb as A,Sb as R,Tb as k,Ua as v,Uc as f,Wc as y,dd as C,ea as m,hd as w,ja as F,ka as L,kc as D,lc as h,mb as S,nb as P,ob as M,oc as j,pb as I,qb as T,qd as O,rb as p,sb as n,ta as c,tb as s,ub as u,zb as V}from"./chunk-HR6XHDMR.js";var H=(()=>{let o=class o{constructor(){this.filtersChanged=j(),this.exerciseApiService=m(U),this.authService=m(z),this.exerciseLogApiService=m(_),this.titleCasePipe=m(W),this.userSelector=e=>e?.name??"",this.exerciseFormatter=e=>this.titleCasePipe.transform(e),this.weightFormatter=e=>isNaN(parseInt(e??""))?"":`${e}kg`,this.exerciseSelector=e=>typeof e=="string"?"":this.titleCasePipe.transform(e?.name)??"",this.userControl=new C(null),this.typeControl=new C(null),this.exerciseControl=new C(null),this.weightControl=new C(null),this.userControlValues=f(this.userControl.valueChanges),this.typeControlValues=f(this.typeControl.valueChanges),this.exerciseControlValues=f(this.exerciseControl.valueChanges),this.weightControlValues=f(this.weightControl.valueChanges),this.users=c([]),this.types=c([]),this.weights=c([]),this.exercises=c([]),this.filters=y({stream:()=>this.exerciseLogApiService.getFilters(this.userControl.value?.userId,this.exerciseControl.value?.exerciseId,this.typeControl.value,this.weightControl.value?+this.weightControl.value:null)}),h(()=>{let e=this.filters.value(),i=this.authService.user.value();e&&(this.users.set([i,...i?.assignedUsers??[]]),this.types.set(e.types),this.weights.set(e.weights.map(t=>`${t}`)),this.exercises.set(this.exerciseApiService.exercises().filter(t=>e.exercisesIds.includes(t.exerciseId))))}),h(()=>{let e=this.userControlValues(),i=this.typeControlValues(),t=this.exerciseControlValues(),a=this.weightControlValues(),d=e?[e.userId]:[],J=i?[i]:[],Q=t?.exerciseId?[t.exerciseId]:[],X=a?[+a]:[];this.filters.reload(),this.filtersChanged.emit({userId:d,exercisesIds:Q,types:J,weights:X})})}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=v({type:o,selectors:[["app-filters"]],outputs:{filtersChanged:"filtersChanged"},decls:9,vars:11,consts:[[1,"col-12","mb-2"],["placeholder","User",3,"control","items","itemSelector"],[1,"row","mb-2","gx-2"],[1,"col-12"],["placeholder","Type",3,"control","items"],["placeholder","Exercise",3,"control","items","itemSelector"],["placeholder","Weight (kg)",3,"control","items","itemSelector"]],template:function(i,t){i&1&&(n(0,"div",0),u(1,"app-typeahead",1),s(),n(2,"div",2)(3,"div",3),u(4,"app-dropdown",4),s()(),n(5,"div",0),u(6,"app-typeahead",5),s(),n(7,"div",0),u(8,"app-typeahead",6),s()),i&2&&(l(),p("control",t.userControl)("items",t.users())("itemSelector",t.userSelector),l(3),p("control",t.typeControl)("items",t.types()),l(2),p("control",t.exerciseControl)("items",t.exercises())("itemSelector",t.exerciseSelector),l(2),p("control",t.weightControl)("items",t.weights())("itemSelector",t.weightFormatter))},dependencies:[B,w,O,K,$],encapsulation:2,changeDetection:0});let r=o;return r})();function Z(r,o){if(r&1&&(n(0,"span",3),b(1),s()),r&2){let g=x();l(),N(g.filtersCount())}}function ee(r,o){if(r&1&&u(0,"app-exercise-log",9),r&2){let g=o.$implicit;p("exerciseLog",g)}}function te(r,o){r&1&&(n(0,"div",10),b(1,"No results found"),s())}function ie(r,o){if(r&1){let g=V();n(0,"app-paginator",12),k("currentPageChange",function(i){F(g);let t=x();return R(t.currentPage,i)||(t.currentPage=i),L(i)}),s()}if(r&2){let g,e=x();A("currentPage",e.currentPage),p("pageCount",((g=e.logsResource.value())==null?null:g.pageCount)??0)}}var Ee=(()=>{let o=class o{constructor(){this.exerciseLogApiService=m(_),this.showFilters=c(!1),this.currentPage=c(0),this.filter=c(null),this.filtersCount=D(()=>{let e=this.filter();return e?Object.values(e).reduce((i,t)=>i+t.length,0):0}),this.logsResource=y({params:this.filter,stream:({params:e})=>{let i=e?.userId.at(0),t=e?.types.at(0),a=e?.exercisesIds.at(0),d=e?.weights.at(0);return this.exerciseLogApiService.getExerciseLogs(this.currentPage(),i,t??null,a??null,d??null)}}),this.logs=D(()=>this.logsResource.isLoading()?[null,null,null,null,null]:this.logsResource.value()?.data),h(()=>{this.currentPage(),this.logsResource.reload()})}onFilterChange(e){this.currentPage.set(0),this.filter.set(e),this.logsResource.reload()}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=v({type:o,selectors:[["app-exercise-logs-page"]],decls:13,vars:4,consts:[[1,"header-footer-padding"],[1,"container"],[1,"d-flex","justify-content-end"],[1,"active-filters"],[1,"btn","btn-secondary",3,"click"],[1,"fa","fa-sliders"],[1,"mt-2",3,"hidden"],[3,"filtersChanged"],[1,"mt-2"],[3,"exerciseLog"],[1,"d-flex","justify-content-center","align-items-center","my-5"],[3,"currentPage","pageCount"],[3,"currentPageChange","currentPage","pageCount"]],template:function(i,t){if(i&1&&(n(0,"div",0)(1,"div",1)(2,"div",2),S(3,Z,2,1,"span",3),n(4,"button",4),E("click",function(){return t.showFilters.set(!t.showFilters())}),u(5,"i",5),s()(),n(6,"div",6)(7,"app-filters",7),E("filtersChanged",function(d){return t.onFilterChange(d)}),s()(),n(8,"div",8),I(9,ee,1,1,"app-exercise-log",9,M,!1,te,2,0,"div",10),s(),S(12,ie,1,2,"app-paginator",11),s()()),i&2){let a;l(3),P(t.filtersCount()?3:-1),l(3),p("hidden",!t.showFilters()),l(3),T(t.logs()),l(3),P((a=t.logs())!=null&&a.length?12:-1)}},dependencies:[w,G,H,q],styles:[".toggle-filters[_ngcontent-%COMP%]{border:1px solid white;border-radius:5px;width:2rem;height:2rem}.active-filters[_ngcontent-%COMP%]{display:inline;position:relative;text-align:center;background:#ef4444;border-radius:100%;width:18px;height:18px;font-size:12px;font-weight:700;top:-6px;right:-44px}"],changeDetection:0});let r=o;return r})();export{Ee as ExerciseLogsPageComponent};
