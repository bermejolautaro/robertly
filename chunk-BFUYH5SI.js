import{a as ee}from"./chunk-XL2GRWJJ.js";import{a as Z}from"./chunk-TYQOADUA.js";import{c as V,d as L,n as W,q as Y,w as h}from"./chunk-FEJMBTUO.js";import{B as K,J as Q,b as N,d as q,e as j,f as p,g as z,h as G,i as U,j as B,k as m,m as X,o as $,q as H,r as J}from"./chunk-WTXVKF6G.js";import{Bb as g,Fb as o,Gb as i,Hb as a,Ia as E,Ic as D,Ka as w,Kb as x,Mb as u,Mc as O,Nb as T,R as y,Ya as n,Yb as c,_b as k,gc as I,ib as P,ma as d,nb as b,t as F,ua as S,va as _,wb as l,x as f,xc as A,yb as M,yc as R}from"./chunk-VRIC2HH7.js";var oe=()=>["g","ml"];function ie(r,C){r&1&&a(0,"i",15)}function ne(r,C){r&1&&(a(0,"span",17),o(1,"span",18),c(2,"Loading..."),i())}function re(r,C){if(r&1){let e=x();o(0,"button",19),u("click",function(){S(e);let t=T();return _(t.openDeleteModal())}),a(1,"i",20),o(2,"span"),c(3,"Delete"),i()()}}var Se=(()=>{class r{constructor(){this.location=d(D),this.router=d(L),this.toastService=d(W),this.titleCasePipe=d(O),this.route=d(V),this.modalService=d(K),this.foodsApiService=d(ee),this.foodIdFromRoute=E(void 0,{alias:"id"}),this.url=N(this.route.url,{initialValue:[]}),this.mode=A(()=>this.url().some(e=>e.path===h.CREATE)?"create":"edit"),this.food=q({loader:()=>{let e=this.foodIdFromRoute();return e?this.foodsApiService.getFoodById(e):F(null)}}),this.isSaveLoading=w(!1),this.titleCaseSelector=e=>e?this.titleCasePipe.transform(e):"",this.foodForm=new U({name:new m("",[p.required]),calories:new m(null,[p.required]),protein:new m(null,[p.required]),fat:new m(null),unit:new m("",[p.required]),amount:new m(null,[p.required])}),R(()=>{let e=this.food.value();e&&this.foodForm.patchValue({name:e.name,calories:e.calories,protein:e.protein,fat:e.fat,unit:e.unit,amount:e.amount})})}openDeleteModal(){let e=this.modalService.open(Y,{centered:!0});e.componentInstance.configurate({title:"Delete Record",subtitle:"<strong>Are you sure you want to delete this record?</strong>",body:'This record will be permanently deleted. <span class="text-danger">This operation can not be undone.</span>',okType:"danger"}),e.closed.pipe(y(1)).subscribe(async()=>{let t=this.food.value();if(t?.foodId)try{await f(this.foodsApiService.deleteFood(t.foodId)),this.router.navigate([h.EXERCISES])}catch(v){let te=v;this.toastService.error(`${te.message}`)}})}async save(){if(this.foodForm.invalid)return;this.isSaveLoading.set(!0),this.foodForm.disable();let e={foodId:this.food.value()?.foodId??null,name:this.foodForm.value.name,calories:this.foodForm.value.calories,protein:this.foodForm.value.protein,fat:this.foodForm.value.fat,unit:this.foodForm.value.unit.toLowerCase(),amount:this.foodForm.value.amount};try{this.mode()==="create"?await f(this.foodsApiService.createFood(e)):await f(this.foodsApiService.updateFood(e))}catch{this.toastService.error("An error occurred while saving the exercise.")}finally{this.isSaveLoading.set(!1),this.foodForm.enable(),this.router.navigate([h.FOODS])}}cancel(){this.location.back()}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275cmp=P({type:r,selectors:[["edit-food-page"]],inputs:{foodIdFromRoute:[1,"id","foodIdFromRoute"]},decls:29,vars:16,consts:[[1,"header-footer-padding"],[1,"container"],[1,"pb-3"],[1,"title"],[1,"mb-3"],["type","text","placeholder","Name",1,"form-control",3,"formControl"],["type","text","placeholder","Calories",1,"form-control",3,"formControl"],["type","text","placeholder","Protein",1,"form-control",3,"formControl"],["type","text","placeholder","Fat",1,"form-control",3,"formControl"],["placeholder","Unit",3,"control","items"],["type","text","placeholder","Amount Per Unit",1,"form-control",3,"formControl"],[1,"row","g-2","mb-3"],[1,"col"],["type","button",1,"btn","btn-secondary","w-100",3,"click"],["type","button",1,"btn","w-100","d-flex","justify-content-center","align-items-center",3,"click","disabled"],["aria-hidden","true",1,"fa","fa-save","px-2"],["type","button",1,"btn","btn-danger","w-100","delete-button"],["aria-hidden","true",1,"spinner-border","spinner-border-sm","mx-2"],["role","status",1,"visually-hidden"],["type","button",1,"btn","btn-danger","w-100","delete-button",3,"click"],["aria-hidden","true",1,"fa","fa-trash","px-2"]],template:function(s,t){s&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),c(4),i()(),o(5,"div")(6,"form")(7,"div",4),a(8,"input",5),i(),o(9,"div",4),a(10,"input",6),i(),o(11,"div",4),a(12,"input",7),i(),o(13,"div",4),a(14,"input",8),i(),o(15,"div",4),a(16,"app-typeahead",9),i(),o(17,"div",4),a(18,"input",10),i()()(),o(19,"div",11)(20,"div",12)(21,"button",13),u("click",function(){return t.cancel()}),c(22," Cancel "),i()(),o(23,"div",12)(24,"button",14),u("click",function(){return t.save()}),b(25,ie,1,0,"i",15)(26,ne,3,0),c(27," Save "),i()()(),b(28,re,4,0,"button",16),i()()),s&2&&(n(4),k("",t.mode()==="edit"?"Edit":"Create"," Food"),n(4),l("formControl",t.foodForm.controls.name),n(2),l("formControl",t.foodForm.controls.calories),n(2),l("formControl",t.foodForm.controls.protein),n(2),l("formControl",t.foodForm.controls.fat),n(2),l("control",t.foodForm.controls.unit)("items",I(15,oe)),n(2),l("formControl",t.foodForm.controls.amount),n(6),M("btn-primary",t.foodForm.valid)("btn-secondary",t.foodForm.invalid),l("disabled",t.foodForm.invalid||t.isSaveLoading()),n(),g(t.isSaveLoading()?26:25),n(3),g(t.mode()==="edit"?28:-1))},dependencies:[J,X,j,z,G,$,H,B,Q,Z],styles:["[_nghost-%COMP%]{--bs-body-bg: var(--light-bg);--bs-body-color: var(--font-color);--bs-tertiary-bg: var(--primary);--bs-border-width: 1px;--bs-border-color: rgba(255, 255, 255, .15)}.card[_ngcontent-%COMP%]{--bs-card-spacer-y: .5rem;--bs-card-spacer-x: .5rem}.title[_ngcontent-%COMP%]{margin:0}.subtitle[_ngcontent-%COMP%]{font-size:14px;opacity:.7}.card[_ngcontent-%COMP%]{background-color:var(--bg);border:1px solid rgba(255,255,255,.1)}.serie-label[_ngcontent-%COMP%]{font-size:12px;color:#ffffffbf;padding:0 .5rem}.delete-button[_ngcontent-%COMP%]{background-color:#301b23;--bs-btn-border-color: #6e363b;color:#fa8989}"],changeDetection:0})}}return r})();export{Se as EditFoodPageComponent};
