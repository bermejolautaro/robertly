import{a as ee}from"./chunk-6AEIWYRT.js";import{a as te}from"./chunk-3OZCGGDQ.js";import{G as Y,M as Z,c as w,d as D,f as K,g as F,n as u,s as g,t as z,u as G,v as H,w as J,x as Q,y as X,z as I}from"./chunk-EHUSIADG.js";import{d as q,h as W,j as P}from"./chunk-T2LPKCIQ.js";import{Ab as p,Cb as R,Gb as y,Hb as x,Hc as U,Ib as _,Ja as C,Jb as r,Ka as v,Kb as n,Kc as T,Lb as l,Ob as $,Sb as m,Tb as M,bb as s,ca as L,cc as b,dc as j,ec as S,jb as h,oc as B,pa as d,rc as V,sc as k,tb as c,vb as O,xa as A,ya as N}from"./chunk-D6SZDTIS.js";var ae=i=>({active:i});function ce(i,E){if(i&1){let e=$();r(0,"button",8),m("click",function(){let t=A(e).$implicit,a=M();return N(a.control().patchValue(t))}),b(1),V(2,"titlecase"),n()}if(i&2){let e=E.$implicit,o=M();p("ngClass",B(4,ae,o.isActive()(e))),s(),S(" ",k(2,2,o.formatter()(e))," ")}}var ie=(()=>{class i{constructor(){this.placeholder=v("Placeholder"),this.control=O(new u(null)),this.items=v([]),this.formatter=v(e=>`${e??""}`),this.isActive=v(()=>!1),this.clearFilterClicked=C(),this.elementSelected=C(),this.selectedValue=c("")}ngOnInit(){this.control().valueChanges.pipe(L(null)).subscribe(e=>{this.selectedValue.set(e?this.formatter()(e):this.placeholder())})}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=h({type:i,selectors:[["app-dropdown"]],inputs:{placeholder:[1,"placeholder"],control:[1,"control"],items:[1,"items"],formatter:[1,"formatter"],isActive:[1,"isActive"]},outputs:{control:"controlChange",clearFilterClicked:"clearFilterClicked",elementSelected:"elementSelected"},decls:11,vars:5,consts:[["ngbDropdown","",1,"d-flex","justify-content-center"],[1,"input-group","flex-nowrap","has-validation"],["type","button","ngbDropdownToggle","",1,"btn","btn-outline-primary","d-flex","justify-content-between","align-items-center","w-100","dropdown"],[1,"dropdown-label"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fa","fa-times"],["ngbDropdownMenu","",1,"w-100"],["ngbDropdownItem","",3,"ngClass"],["ngbDropdownItem","",3,"click","ngClass"]],template:function(o,t){o&1&&(r(0,"div",0)(1,"div",1)(2,"button",2)(3,"span",3),b(4),V(5,"titlecase"),n()(),r(6,"button",4),m("click",function(){return t.control().patchValue(null)}),l(7,"i",5),n(),r(8,"div",6),x(9,ce,3,6,"button",7,y),n()()()),o&2&&(s(3),R("active",t.control().value),s(),j(k(5,3,t.selectedValue())),s(5),_(t.items()))},dependencies:[z,g,I,X,Q,J,G,H,P,W],styles:["[_nghost-%COMP%]{display:block;width:100%}.dropdown[_ngcontent-%COMP%]{border-top-right-radius:0;border-bottom-right-radius:0;--bs-btn-color: var(--body-bg);--bs-btn-border-color: var(--bs-border-color);--bs-btn-hover-border-color: var(--bs-border-color)}.dropdown[_ngcontent-%COMP%]   button.btn-outline-primary.show[_ngcontent-%COMP%], .dropdown[_ngcontent-%COMP%]   button.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:transparent;--bs-btn-active-border-color: var(--bs-border-color)}.dropdown-label[_ngcontent-%COMP%]{opacity:.6}.dropdown-label.active[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0})}}return i})();var re=(()=>{class i{constructor(){this.filtersChanged=C(),this.exerciseLogService=d(K),this.authService=d(Z),this.exerciseLogApiService=d(F),this.titleCasePipe=d(P),this.userSelector=e=>e?.name??"",this.exerciseFormatter=e=>this.titleCasePipe.transform(e),this.weightFormatter=e=>isNaN(parseInt(e??""))?"":`${e}kg`,this.exerciseSelector=e=>typeof e=="string"?"":this.titleCasePipe.transform(e?.name)??"",this.userControl=new u(null),this.typeControl=new u(null),this.exerciseControl=new u(null),this.weightControl=new u(null),this.userControlValues=w(this.userControl.valueChanges),this.typeControlValues=w(this.typeControl.valueChanges),this.exerciseControlValues=w(this.exerciseControl.valueChanges),this.weightControlValues=w(this.weightControl.valueChanges),this.users=c([]),this.types=c([]),this.weights=c([]),this.exercises=c([]),this.filters=D({loader:()=>this.exerciseLogApiService.getFilters(this.userControl.value?.userId,this.exerciseControl.value?.exerciseId,this.typeControl.value,this.weightControl.value?+this.weightControl.value:null)}),this.#e=T(()=>{let e=this.filters.value(),o=this.authService.user();e&&(this.users.set([o,...o?.assignedUsers??[]]),this.types.set(e.types),this.weights.set(e.weights.map(t=>`${t}`)),this.exercises.set(this.exerciseLogService.exercises().filter(t=>e.exercisesIds.includes(t.exerciseId))))}),this.#t=T(()=>{let e=this.userControlValues(),o=this.typeControlValues(),t=this.exerciseControlValues(),a=this.weightControlValues(),f=e?[e.userId]:[],ne=o?[o]:[],se=t?.exerciseId?[t.exerciseId]:[],le=a?[+a]:[];this.filters.reload(),this.filtersChanged.emit({userId:f,exercisesIds:se,types:ne,weights:le})})}#e;#t;static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=h({type:i,selectors:[["app-filters"]],outputs:{filtersChanged:"filtersChanged"},decls:9,vars:11,consts:[[1,"col-12","mb-2"],["placeholder","User",3,"control","items","itemSelector"],[1,"row","mb-2","gx-2"],[1,"col-12"],["placeholder","Type",3,"control","items"],["placeholder","Exercise",3,"control","items","itemSelector"],["placeholder","Weight (kg)",3,"control","items","itemSelector"]],template:function(o,t){o&1&&(r(0,"div",0),l(1,"app-typeahead",1),n(),r(2,"div",2)(3,"div",3),l(4,"app-dropdown",4),n()(),r(5,"div",0),l(6,"app-typeahead",5),n(),r(7,"div",0),l(8,"app-typeahead",6),n()),o&2&&(s(),p("control",t.userControl)("items",t.users())("itemSelector",t.userSelector),s(3),p("control",t.typeControl)("items",t.types()),s(2),p("control",t.exerciseControl)("items",t.exercises())("itemSelector",t.exerciseSelector),s(2),p("control",t.weightControl)("items",t.weights())("itemSelector",t.weightFormatter))},dependencies:[Y,g,I,ee,ie],styles:[".dropdown-item{background-color:var(--light-bg)}"],changeDetection:0})}}return i})();function pe(i,E){if(i&1&&l(0,"app-exercise-log",8),i&2){let e=E.$implicit;p("exerciseLog",e)}}var Ue=(()=>{class i{constructor(){this.document=d(q),this.exerciseLogApiService=d(F),this.currentPage=c(0),this.filter=c(null),this.logsResource=D({request:this.filter,loader:({request:e})=>{let o=e?.userId.at(0),t=e?.types.at(0),a=e?.exercisesIds.at(0),f=e?.weights.at(0);return this.exerciseLogApiService.getExerciseLogs(this.currentPage(),o,t??null,a??null,f??null)}}),this.logs=U(()=>this.logsResource.isLoading()?[null,null,null,null,null]:this.logsResource.value())}ngOnInit(){this.document.defaultView?.scroll({top:0,left:0,behavior:"smooth"})}onFilterChange(e){this.currentPage.set(0),this.filter.set(e),this.logsResource.reload()}prevPage(){let e=this.currentPage();this.currentPage.update(o=>Math.max(o-1,0)),e!==this.currentPage()&&this.logsResource.reload()}nextPage(){let e=this.currentPage();this.currentPage.update(o=>o+1),e!==this.currentPage()&&this.logsResource.reload()}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=h({type:i,selectors:[["app-exercise-logs-page"]],decls:12,vars:1,consts:[[1,"footer-padding"],[1,"container"],[3,"filtersChanged"],[1,"container","d-flex","justify-content-end","align-items-center","gap-2"],[1,"btn","btn-secondary",3,"click"],[1,"fa","fa-angle-left"],[1,"fa","fa-angle-right"],[1,"mt-4"],[3,"exerciseLog"]],template:function(o,t){o&1&&(r(0,"div",0)(1,"div",1)(2,"app-filters",2),m("filtersChanged",function(f){return t.onFilterChange(f)}),n(),r(3,"div",3)(4,"button",4),m("click",function(){return t.prevPage()}),l(5,"i",5),n(),b(6),r(7,"button",4),m("click",function(){return t.nextPage()}),l(8,"i",6),n()(),r(9,"div",7),x(10,pe,1,1,"app-exercise-log",8,y),n()()()),o&2&&(s(6),S(" ",t.currentPage()+1," "),s(4),_(t.logs()))},dependencies:[g,te,re],encapsulation:2,changeDetection:0})}}return i})();export{Ue as ExerciseLogsPageComponent};
