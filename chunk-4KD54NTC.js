import{a as J}from"./chunk-B64AY7BL.js";import{B as C,C as j,D as R,E as U,F as W,G as q,H as z,I as v,W as G,ca as H,d as h,e as L,o as $,p as B,w as p}from"./chunk-XKYEPMQN.js";import{h as A,j as g}from"./chunk-MYBBF3QI.js";import{Ab as a,Ga as f,Gb as k,Hc as D,Ib as P,Ja as I,Jb as E,Kb as n,Lb as s,Mb as c,Pb as T,Tb as b,Ub as w,bb as r,cc as y,da as F,dc as N,ec as O,jb as u,lc as S,oc as x,pc as _,qa as m,tb as l,ya as M,za as V}from"./chunk-26H5WKEY.js";var oe=i=>({"dropdown-label":!0,active:i}),ie=i=>({active:i});function re(i,Q){if(i&1){let e=T();n(0,"button",8),b("click",function(){let t=M(e).$implicit,d=w();return V(d.control.patchValue(t))}),y(1),x(2,"titlecase"),s()}if(i&2){let e=Q.$implicit,o=w();a("ngClass",S(4,ie,o.isActive(e))),r(),O(" ",_(2,2,o.formatter(e))," ")}}var K=(()=>{class i{constructor(){this.placeholder="Placeholder",this.control=new p(null),this.items=l([]),this.isActive=()=>!1,this.formatter=e=>`${e??""}`,this.clearFilterClicked=new f,this.elementSelected=new f,this.selectedValue=l("")}ngOnInit(){this.control.valueChanges.pipe(F(null)).subscribe(e=>{this.selectedValue.set(this.control.value?this.formatter(this.control.value):this.placeholder)})}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=u({type:i,selectors:[["app-dropdown"]],inputs:{placeholder:"placeholder",control:"control",items:"items",isActive:"isActive",formatter:"formatter"},outputs:{clearFilterClicked:"clearFilterClicked",elementSelected:"elementSelected"},decls:11,vars:6,consts:[["ngbDropdown","",1,"d-flex","justify-content-center"],[1,"input-group","flex-nowrap","has-validation"],["type","button","ngbDropdownToggle","",1,"btn","btn-outline-primary","d-flex","justify-content-between","align-items-center","w-100","dropdown"],[3,"ngClass"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fa","fa-times"],["ngbDropdownMenu","",1,"w-100"],["ngbDropdownItem","",3,"ngClass"],["ngbDropdownItem","",3,"click","ngClass"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1)(2,"button",2)(3,"span",3),y(4),x(5,"titlecase"),s()(),n(6,"button",4),b("click",function(){return t.control.patchValue(null)}),c(7,"i",5),s(),n(8,"div",6),P(9,re,3,6,"button",7,k),s()()()),o&2&&(r(3),a("ngClass",S(4,oe,t.control.value)),r(),N(_(5,2,t.selectedValue())),r(5),E(t.items()))},dependencies:[j,C,v,z,q,W,R,U,g,A],styles:["[_nghost-%COMP%]{display:block;width:100%}.dropdown[_ngcontent-%COMP%]{border-top-right-radius:0;border-bottom-right-radius:0;--bs-btn-color: var(--body-bg);--bs-btn-border-color: var(--bs-border-color);--bs-btn-hover-border-color: var(--bs-border-color)}.dropdown[_ngcontent-%COMP%]   button.btn-outline-primary.show[_ngcontent-%COMP%], .dropdown[_ngcontent-%COMP%]   button.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:transparent;--bs-btn-active-border-color: var(--bs-border-color)}.dropdown-label[_ngcontent-%COMP%]{opacity:.6}.dropdown-label.active[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0})}}return i})();var Ve=(()=>{class i{constructor(){this.filtersChanged=I(),this.exerciseLogService=m($),this.authService=m(H),this.exerciseLogApiService=m(B),this.titleCasePipe=m(g),this.userSelector=e=>e?.name??"",this.exerciseFormatter=e=>this.titleCasePipe.transform(e),this.weightFormatter=e=>isNaN(parseInt(e??""))?"":`${e}kg`,this.exerciseSelector=e=>typeof e=="string"?"":this.titleCasePipe.transform(e?.name)??"",this.userControl=new p(null),this.typeControl=new p(null),this.exerciseControl=new p(null),this.weightControl=new p(null),this.userControlValues=h(this.userControl.valueChanges),this.typeControlValues=h(this.typeControl.valueChanges),this.exerciseControlValues=h(this.exerciseControl.valueChanges),this.weightControlValues=h(this.weightControl.valueChanges),this.users=l([]),this.types=l([]),this.weights=l([]),this.exercises=l([]),this.filters=L({loader:()=>this.exerciseLogApiService.getFilters(this.userControl.value?.userId,this.exerciseControl.value?.exerciseId,this.typeControl.value,this.weightControl.value?+this.weightControl.value:null)}),this.#e=D(()=>{let e=this.filters.value(),o=this.authService.user();e&&(this.users.set([o,...o?.assignedUsers??[]]),this.types.set(e.types),this.weights.set(e.weights.map(t=>`${t}`)),this.exercises.set(this.exerciseLogService.exercises().filter(t=>e.exercisesIds.includes(t.exerciseId))))}),this.#t=D(()=>{let e=this.userControlValues(),o=this.typeControlValues(),t=this.exerciseControlValues(),d=this.weightControlValues(),X=e?[e.userId]:[],Y=o?[o]:[],Z=t?.exerciseId?[t.exerciseId]:[],ee=d?[+d]:[];this.filters.reload(),this.filtersChanged.emit({userId:X,exercisesIds:Z,types:Y,weights:ee})})}#e;#t;static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=u({type:i,selectors:[["app-filters"]],outputs:{filtersChanged:"filtersChanged"},decls:10,vars:11,consts:[[1,"container"],[1,"col-12","mb-2"],["placeholder","User",3,"control","items","itemSelector"],[1,"row","mb-2","gx-2"],[1,"col-12"],["placeholder","Type",3,"control","items"],["placeholder","Exercise",3,"control","items","itemSelector"],["placeholder","Weight (kg)",3,"control","items","itemSelector"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1),c(2,"app-typeahead",2),s(),n(3,"div",3)(4,"div",4),c(5,"app-dropdown",5),s()(),n(6,"div",1),c(7,"app-typeahead",6),s(),n(8,"div",1),c(9,"app-typeahead",7),s()()),o&2&&(r(2),a("control",t.userControl)("items",t.users())("itemSelector",t.userSelector),r(3),a("control",t.typeControl)("items",t.types),r(2),a("control",t.exerciseControl)("items",t.exercises())("itemSelector",t.exerciseSelector),r(2),a("control",t.weightControl)("items",t.weights())("itemSelector",t.weightFormatter))},dependencies:[G,C,v,J,K],styles:[".dropdown-item{background-color:var(--light-bg)}"],changeDetection:0})}}return i})();export{Ve as a};
