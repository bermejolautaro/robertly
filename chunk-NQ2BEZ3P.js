import{a as Y}from"./chunk-CURLB4BX.js";import{d as R,f as G,q as Q,r as U,u as W,w as v}from"./chunk-BHSDRSSQ.js";import{$c as q,Bb as u,Db as M,Gc as D,Ka as s,Kc as I,Lb as P,N as y,Nb as d,Pb as T,Ua as F,Uc as N,Yc as V,Zc as b,_c as O,ad as j,bd as z,cd as h,ea as a,ed as X,fd as $,gd as B,hd as H,ja as S,ka as E,kc as C,lc as A,mb as f,nb as x,pc as L,rb as m,rd as J,sb as i,ta as _,tb as r,ub as l,y as p,yc as k,zb as w,zd as K}from"./chunk-DCXKOQXA.js";function te(o,n){o&1&&l(0,"i",12)}function ie(o,n){o&1&&(l(0,"span",14),i(1,"span",15),d(2,"Loading..."),r())}function re(o,n){if(o&1){let Z=w();i(0,"button",16),u("click",function(){S(Z);let c=M();return E(c.openDeleteModal())}),l(1,"i",17),i(2,"span"),d(3,"Delete"),r()()}}var Ce=(()=>{let n=class n{constructor(){this.location=a(D),this.router=a(G),this.toastService=a(U),this.titleCasePipe=a(I),this.route=a(R),this.modalService=a(J),this.exerciseApiService=a(Q),this.exerciseIdFromRoute=L(null,{alias:"id",transform:k}),this.url=N(this.route.url,{initialValue:[]}),this.mode=C(()=>this.url().some(e=>e.path===v.CREATE)?"create":"edit"),this.exercise=C(()=>this.exerciseApiService.exercises().find(e=>e.exerciseId===this.exerciseIdFromRoute())),this.isSaveLoading=_(!1),this.titleCaseSelector=e=>e?this.titleCasePipe.transform(e):"",this.exerciseForm=new j({name:new h("",[b.required]),muscleGroup:new h("",[b.required]),type:new h("",[b.required])}),A(()=>{let e=this.exercise();e&&this.exerciseForm.patchValue({name:e.name,muscleGroup:e.muscleGroup,type:e.type})})}openDeleteModal(){let e=this.modalService.open(W,{centered:!0});e.componentInstance.configurate({title:"Delete Record",subtitle:"<strong>Are you sure you want to delete this record?</strong>",body:'This record will be permanently deleted. <span class="text-danger">This operation can not be undone.</span>',okType:"danger"}),e.closed.pipe(y(1)).subscribe(async()=>{let t=this.exercise();if(t?.exerciseId)try{await p(this.exerciseApiService.deleteExercise(t.exerciseId)),this.router.navigate([v.EXERCISES])}catch(g){let ee=g;this.toastService.error(`${ee.message}`)}})}async save(){this.isSaveLoading.set(!0),this.exerciseForm.disable();try{if(this.mode()==="create"){let e={name:this.exerciseForm.value.name.toLowerCase(),muscleGroup:this.exerciseForm.value.muscleGroup.toLowerCase(),type:this.exerciseForm.value.type.toLowerCase()};await p(this.exerciseApiService.createExercise(e))}else{let e={exerciseId:this.exercise().exerciseId,name:this.exerciseForm.value.name.toLowerCase(),muscleGroup:this.exerciseForm.value.muscleGroup.toLowerCase(),type:this.exerciseForm.value.type.toLowerCase()};await p(this.exerciseApiService.updateExercise(e))}}catch{this.toastService.error("An error ocurred while saving the exercise.")}finally{this.isSaveLoading.set(!1),this.exerciseForm.enable(),this.router.navigate([v.EXERCISES])}}cancel(){this.location.back()}};n.\u0275fac=function(c){return new(c||n)},n.\u0275cmp=F({type:n,selectors:[["edit-exercise-page"]],inputs:{exerciseIdFromRoute:[1,"id","exerciseIdFromRoute"]},decls:23,vars:15,consts:[[1,"header-footer-padding"],[1,"container"],[1,"pb-3"],[1,"title"],[1,"mb-3"],["type","text","placeholder","Name",1,"form-control",3,"formControl"],["placeholder","Muscle Group",3,"control","items","itemSelector"],["placeholder","Type",3,"control","items","itemSelector"],[1,"row","g-2","mb-3"],[1,"col"],["type","button",1,"btn","btn-secondary","w-100",3,"click"],["type","button",1,"btn","w-100","d-flex","justify-content-center","align-items-center",3,"click","disabled"],["aria-hidden","true",1,"fa","fa-save","px-2"],["type","button",1,"btn","btn-danger","w-100","delete-button"],["aria-hidden","true",1,"spinner-border","spinner-border-sm","mx-2"],["role","status",1,"visually-hidden"],["type","button",1,"btn","btn-danger","w-100","delete-button",3,"click"],["aria-hidden","true",1,"fa","fa-trash","px-2"]],template:function(c,t){c&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),d(4),r()(),i(5,"div")(6,"form")(7,"div",4),l(8,"input",5),r(),i(9,"div",4),l(10,"app-typeahead",6),r(),i(11,"div",4),l(12,"app-typeahead",7),r()()(),i(13,"div",8)(14,"div",9)(15,"button",10),u("click",function(){return t.cancel()}),d(16," Cancel "),r()(),i(17,"div",9)(18,"button",11),u("click",function(){return t.save()}),f(19,te,1,0,"i",12)(20,ie,3,0),d(21," Save "),r()()(),f(22,re,4,0,"button",13),r()()),c&2&&(s(4),T("",t.mode()==="edit"?"Edit":"Create"," Exercise"),s(4),m("formControl",t.exerciseForm.controls.name),s(2),m("control",t.exerciseForm.controls.muscleGroup)("items",t.exerciseApiService.muscleGroups())("itemSelector",t.titleCaseSelector),s(2),m("control",t.exerciseForm.controls.type)("items",t.exerciseApiService.types())("itemSelector",t.titleCaseSelector),s(6),P("btn-primary",t.exerciseForm.valid)("btn-secondary",t.exerciseForm.invalid||t.isSaveLoading()),m("disabled",t.exerciseForm.invalid||t.isSaveLoading()),s(),x(t.isSaveLoading()?20:19),s(3),x(t.mode()==="edit"?22:-1))},dependencies:[H,X,V,O,q,$,B,z,K,Y],styles:["[_nghost-%COMP%]{--bs-body-bg: var(--light-bg);--bs-body-color: var(--font-color);--bs-tertiary-bg: var(--primary);--bs-border-width: 1px;--bs-border-color: rgba(255, 255, 255, .15)}.card[_ngcontent-%COMP%]{--bs-card-spacer-y: .5rem;--bs-card-spacer-x: .5rem}.title[_ngcontent-%COMP%]{margin:0}.subtitle[_ngcontent-%COMP%]{font-size:14px;opacity:.7}.card[_ngcontent-%COMP%]{background-color:var(--bg);border:1px solid rgba(255,255,255,.1)}.serie-label[_ngcontent-%COMP%]{font-size:12px;color:#ffffffbf;padding:0 .5rem}.delete-button[_ngcontent-%COMP%]{background-color:#301b23;--bs-btn-border-color: #6e363b;color:#fa8989}"],changeDetection:0});let o=n;return o})();export{Ce as EditExercisePageComponent};
