import{a as J}from"./chunk-C7DG2V6R.js";import{B as v,C as B,D as j,E as R,F as W,G as q,H as z,I as b,W as G,ca as H,d as u,e as L,o as U,p as $,w as p}from"./chunk-PWFKK35O.js";import{h as A,j as C}from"./chunk-QN4ZLGYB.js";import{Fb as k,Fc as g,Ga as f,Hb as E,Ib as P,Ja as I,Jb as n,Kb as s,Lb as c,Ob as T,Sb as w,Tb as y,bb as r,bc as S,cc as N,da as F,dc as O,jb as h,kc as x,nc as _,oc as D,qa as m,tb as l,ya as V,za as M,zb as a}from"./chunk-RORB2MO5.js";var oe=i=>({"dropdown-label":!0,active:i}),ie=i=>({active:i});function re(i,Q){if(i&1){let e=T();n(0,"button",8),w("click",function(){let t=V(e).$implicit,d=y();return M(d.control.patchValue(t))}),S(1),_(2,"titlecase"),s()}if(i&2){let e=Q.$implicit,o=y();a("ngClass",x(4,ie,o.isActive(e))),r(),O(" ",D(2,2,o.formatter(e))," ")}}var K=(()=>{class i{constructor(){this.placeholder="Placeholder",this.control=new p(null),this.items=l([]),this.isActive=()=>!1,this.formatter=e=>`${e??""}`,this.clearFilterClicked=new f,this.elementSelected=new f,this.selectedValue=l("")}ngOnInit(){this.control.valueChanges.pipe(F(null)).subscribe(e=>{this.selectedValue.set(this.control.value?this.formatter(this.control.value):this.placeholder)})}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=h({type:i,selectors:[["app-dropdown"]],inputs:{placeholder:"placeholder",control:"control",items:"items",isActive:"isActive",formatter:"formatter"},outputs:{clearFilterClicked:"clearFilterClicked",elementSelected:"elementSelected"},decls:11,vars:6,consts:[["ngbDropdown","",1,"d-flex","justify-content-center"],[1,"input-group","flex-nowrap","has-validation"],["type","button","ngbDropdownToggle","",1,"btn","btn-outline-primary","d-flex","justify-content-between","align-items-center","w-100","dropdown"],[3,"ngClass"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fa","fa-times"],["ngbDropdownMenu","",1,"w-100"],["ngbDropdownItem","",3,"ngClass"],["ngbDropdownItem","",3,"click","ngClass"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1)(2,"button",2)(3,"span",3),S(4),_(5,"titlecase"),s()(),n(6,"button",4),w("click",function(){return t.control.patchValue(null)}),c(7,"i",5),s(),n(8,"div",6),E(9,re,3,6,"button",7,k),s()()()),o&2&&(r(3),a("ngClass",x(4,oe,t.control.value)),r(),N(D(5,2,t.selectedValue())),r(5),P(t.items()))},dependencies:[B,v,b,z,q,W,j,R,C,A],styles:["[_nghost-%COMP%]{display:block;width:100%}.dropdown[_ngcontent-%COMP%]{border-top-right-radius:0;border-bottom-right-radius:0;--bs-btn-color: var(--body-bg);--bs-btn-border-color: var(--bs-border-color);--bs-btn-hover-border-color: var(--bs-border-color)}.dropdown[_ngcontent-%COMP%]   button.btn-outline-primary.show[_ngcontent-%COMP%], .dropdown[_ngcontent-%COMP%]   button.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:transparent;--bs-btn-active-border-color: var(--bs-border-color)}.dropdown-label[_ngcontent-%COMP%]{opacity:.6}.dropdown-label.active[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0})}}return i})();var Me=(()=>{class i{constructor(){this.filtersChanged=I(),this.exerciseLogService=m($),this.authService=m(H),this.exerciseLogApiService=m(U),this.titleCasePipe=m(C),this.exerciseFormatter=e=>this.titleCasePipe.transform(e),this.weightFormatter=e=>isNaN(parseInt(e??""))?"":`${e}kg`,this.exerciseSelector=e=>e?.name??"",this.userSelector=e=>e?.name??"",this.userControl=new p(null),this.typeControl=new p(null),this.exerciseControl=new p(null),this.weightControl=new p(null),this.userControlValues=u(this.userControl.valueChanges),this.typeControlValues=u(this.typeControl.valueChanges),this.exerciseControlValues=u(this.exerciseControl.valueChanges),this.weightControlValues=u(this.weightControl.valueChanges),this.users=l([]),this.types=l([]),this.weights=l([]),this.exercises=l([]),this.filters=L({loader:()=>this.exerciseLogApiService.getFilters(this.userControl.value?.userFirebaseUuid,this.exerciseControl.value?.exerciseId,this.typeControl.value,this.weightControl.value?+this.weightControl.value:null)}),this.#e=g(()=>{let e=this.authService.user();e&&this.userControl.patchValue(e)}),this.#t=g(()=>{let e=this.filters.value(),o=this.authService.user();e&&(this.users.set([o]),this.types.set(e.types),this.weights.set(e.weights.map(t=>`${t}`)),this.exercises.set(this.exerciseLogService.exercises().filter(t=>e.exercisesIds.includes(t.exerciseId))))}),this.#o=g(()=>{let e=this.userControlValues(),o=this.typeControlValues(),t=this.exerciseControlValues(),d=this.weightControlValues(),X=e?[e.userFirebaseUuid]:[],Y=o?[o]:[],Z=t?.exerciseId?[t.exerciseId]:[],ee=d?[+d]:[];this.filters.reload(),this.filtersChanged.emit({userFirebaseUuid:X,exercisesIds:Z,types:Y,weights:ee})})}#e;#t;#o;static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=h({type:i,selectors:[["app-filters"]],outputs:{filtersChanged:"filtersChanged"},decls:10,vars:11,consts:[[1,"container"],[1,"col-12","mb-2"],["placeholder","User",3,"control","items","itemSelector"],[1,"row","mb-2","gx-2"],[1,"col-12"],["placeholder","Type",3,"control","items"],["placeholder","Exercise",3,"control","items","itemSelector"],["placeholder","Weight (kg)",3,"control","items","itemSelector"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1),c(2,"app-typeahead",2),s(),n(3,"div",3)(4,"div",4),c(5,"app-dropdown",5),s()(),n(6,"div",1),c(7,"app-typeahead",6),s(),n(8,"div",1),c(9,"app-typeahead",7),s()()),o&2&&(r(2),a("control",t.userControl)("items",t.users())("itemSelector",t.userSelector),r(3),a("control",t.typeControl)("items",t.types),r(2),a("control",t.exerciseControl)("items",t.exercises())("itemSelector",t.exerciseSelector),r(2),a("control",t.weightControl)("items",t.weights())("itemSelector",t.weightFormatter))},dependencies:[G,v,b,J,K],styles:[".dropdown-item{background-color:var(--light-bg)}"],changeDetection:0})}}return i})();export{Me as a};
