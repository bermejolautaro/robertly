import{a as pe}from"./chunk-RUL5CXK2.js";import{L as ae,N as se,P as le,R as ce,S as de,T as E,a as j,b as B,c as N,d as R,e as z,f as q,g as H,h as J,j as Q,k as W,m as X,p as Z,q as ee,r as te,s as ie,t as re,y as oe,z as ne}from"./chunk-S5623SF4.js";import{f as V,h as Y,j as A,l as K,m as $}from"./chunk-USI3GJ6Y.js";import{Bb as G,Gb as u,Hb as g,Lb as l,Mb as U,Nb as b,R as k,Sb as I,Tb as w,Ub as T,Vb as P,Xb as C,Ya as O,Yb as M,Zb as D,ab as c,lb as m,oa as d,qa as y,qb as x,rb as _,sb as h,ub as v,va as S,vb as f,wa as F,wb as s,xb as n,yb as L}from"./chunk-225B3TJ6.js";var me=(()=>{let i=class i{constructor(){this.modal=d(oe)}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=y({type:i,selectors:[["app-confirm-modal"]],standalone:!0,features:[I],decls:17,vars:0,consts:[[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button","aria-describedby","modal-title",1,"btn-close",3,"click"],[1,"modal-body"],[1,"text-danger"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(r,o){r&1&&(s(0,"div",0)(1,"h4",1),l(2," Profile deletion "),n(),s(3,"button",2),u("click",function(){return o.modal.dismiss("Cross click")}),n()(),s(4,"div",3)(5,"p")(6,"strong"),l(7,"Are you sure you want to delete this record?"),n()(),s(8,"p"),l(9," This record will be permanently deleted. "),s(10,"span",4),l(11,"This operation can not be undone."),n()()(),s(12,"div",5)(13,"button",6),u("click",function(){return o.modal.dismiss()}),l(14," Cancel "),n(),s(15,"button",7),u("click",function(){return o.modal.close()}),l(16," Ok "),n()())},changeDetection:0});let e=i;return e})();function ge(e,i){if(e&1&&(s(0,"div",14),l(1),n()),e&2){let t=i.$implicit;c(1),U(t.value)}}function xe(e,i){if(e&1&&(v(0,ge,2,1,"div",15,h),C(2,"keyvalue")),e&2){let t=g(2);f(M(2,0,t.createOrUpdateLogFormGroup.errors==null?null:t.createOrUpdateLogFormGroup.errors.exercise))}}function _e(e,i){if(e&1&&(s(0,"div",16)(1,"span",17),l(2),n(),L(3,"input",18)(4,"input",19),n()),e&2){let t=i.$implicit,a=i.$index;c(2),b("Serie ",a+1,""),c(1),m("formControl",t.controls.reps),c(1),m("formControl",t.controls.weightInKg)}}function he(e,i){if(e&1&&(s(0,"div",14),l(1),n()),e&2){let t=i.$implicit;c(1),U(t.value)}}function ve(e,i){if(e&1&&(v(0,he,2,1,"div",15,h),C(2,"keyvalue")),e&2){let t=g(2);f(M(2,0,t.createOrUpdateLogFormGroup.errors==null?null:t.createOrUpdateLogFormGroup.errors.series))}}function fe(e,i){if(e&1){let t=G();s(0,"button",20),u("click",function(){S(t);let r=g(2);return F(r.openDeleteModal())}),l(1," Delete "),n()}}function Le(e,i){if(e&1&&L(0,"app-exercise-log",27),e&2){let t=i.$implicit;m("exerciseLog",t)}}function be(e,i){if(e&1&&(s(0,"ul",24)(1,"li",25),l(2),n(),s(3,"li",26),l(4),C(5,"number"),n()()),e&2){let t=i.$implicit,a=i.$index;c(2),b("Serie ",a+1,""),c(2),b("",D(5,2,t.brzycki,"1.2-2"),"kg")}}var Ce=()=>[];function Ee(e,i){if(e&1&&(s(0,"div",21)(1,"div",22),l(2,"Previous entries"),n(),v(3,Le,1,1,"app-exercise-log",28,h),n(),s(5,"div",23)(6,"div",22),l(7,"Possible 1RM (Brzycky Formula)"),n(),v(8,be,6,5,"ul",29,h),s(10,"ul",24)(11,"li",25),l(12,"Average"),n(),s(13,"li",26),l(14),C(15,"number"),n()()()),e&2){let t=g(2),a,r,o;c(3),f((a=(a=t.originalValue())==null?null:a.recentLogs)!==null&&a!==void 0?a:w(4,Ce)),c(5),f((r=t.originalValue())==null?null:r.series),c(6),b("",D(15,1,(o=t.originalValue())==null?null:o.brzyckiAverage,"1.2-2"),"kg")}}var ye=e=>({"justify-content-between":e}),Se=(e,i)=>({"btn-primary":e,"btn-secondary":i});function Fe(e,i){if(e&1){let t=G();s(0,"div",1)(1,"div",2)(2,"h4",3),l(3),n()(),s(4,"div",4)(5,"form"),L(6,"input",5),s(7,"div",6),L(8,"input",7),n(),s(9,"div",6)(10,"div",8),L(11,"app-typeahead",9),n(),x(12,xe,3,2),n(),v(13,_e,5,3,"div",30,h),x(15,ve,3,2),n()(),s(16,"div",10),x(17,fe,2,0,"button",11),s(18,"button",12),u("click",function(){S(t);let r=g();return F(r.cancel())}),l(19," Cancel "),n(),s(20,"button",13),u("click",function(){S(t);let r=g();return F(r.saveExerciseLog())}),l(21," Save "),n(),x(22,Ee,16,5),n()()}if(e&2){let t=g();c(3),b(" ",t.mode==="edit"?"Edit":"Create"," Log "),c(5),m("formControl",t.createOrUpdateLogFormGroup.controls.date),c(3),m("items",t.exerciseLogService.exercises)("control",t.createOrUpdateLogFormGroup.controls.exercise)("itemSelector",t.exerciseSelector),c(1),_(12,t.createOrUpdateLogFormGroup.controls.exercise.pristine?-1:12),c(1),f(t.createOrUpdateLogFormGroup.controls.series.controls),c(2),_(15,t.createOrUpdateLogFormGroup.controls.series.pristine?-1:15),c(1),m("ngClass",T(12,ye,t.mode==="edit")),c(1),_(17,t.mode==="edit"?17:-1),c(3),m("ngClass",P(14,Se,t.createOrUpdateLogFormGroup.valid,t.createOrUpdateLogFormGroup.invalid))("disabled",t.createOrUpdateLogFormGroup.invalid),c(2),_(22,t.mode==="edit"?22:-1)}}function Ie(e,i){e&1&&(s(0,"div",31)(1,"div",32)(2,"span",33),l(3,"Loading..."),n()()())}var et=(()=>{let i=class i{constructor(){this.exerciseLogService=d(H),this.location=d(V),this.router=d(B),this.toastService=d(le),this.authService=d(ce),this.exerciseLogApiService=d(q),this.titleCasePipe=d(A),this.dayjsService=d(z),this.dayjs=this.dayjsService.instance,this.route=d(j),this.modalService=d(ne),this.mode=null,this.createOrUpdateLogFormGroup=null,this.originalValue=O(null),this.isLoading=O(!1),this.exerciseSelector=a=>typeof a=="string"?"":this.titleCasePipe.transform(a?.name)??"",this.route.url.pipe(N()).subscribe(a=>{if(this.createOrUpdateLogFormGroup=de(),a.some(o=>o.path===E.LOGS_CREATE)){this.mode="create";let o=this.dayjs().format("YYYY-MM-DD");this.createOrUpdateLogFormGroup.controls.date.patchValue(o)}else this.initEditMode()})}openDeleteModal(){this.modalService.open(me,{centered:!0}).closed.pipe(k(1)).subscribe(()=>{this.exerciseLogService.deleteLog$.next(this.originalValue())})}saveExerciseLog(){this.isLoading.set(!0),this.mode==="create"?this.createExerciseLog():this.updateExerciseLog(this.originalValue())}cancel(){this.exerciseLogService.refreshLogs$.pipe(k(1)).subscribe(()=>{this.location.back()}),this.exerciseLogService.refreshLogs$.next()}createExerciseLog(){if(this.createOrUpdateLogFormGroup.invalid||typeof this.createOrUpdateLogFormGroup.value.exercise=="string")return;let a=this.authService.user(),r={exerciseLog:{exerciseLogUsername:a?.name??this.createOrUpdateLogFormGroup.value.user.toLocaleLowerCase(),exerciseLogUserId:a?.userId,exerciseLogExerciseId:this.createOrUpdateLogFormGroup.value.exercise.exerciseId,exerciseLogDate:this.dayjsService.parseDate(this.createOrUpdateLogFormGroup.value.date).format("YYYY-MM-DD"),series:(this.createOrUpdateLogFormGroup.value.series??[]).filter(o=>!!o.reps&&!!o.weightInKg).map(o=>({exerciseLogId:o.exerciseLogId,serieId:o.serieId,reps:+o.reps,weightInKg:+o.weightInKg.toFixed(1),brzycki:null}))}};this.exerciseLogApiService.createExerciseLog(r).subscribe({next:o=>{this.createOrUpdateLogFormGroup.reset(),localStorage.removeItem(R),this.toastService.ok("Log created successfully!"),this.router.navigate([E.LOGS,E.LOGS_EDIT,o])},error:()=>{this.toastService.error()}})}updateExerciseLog(a){if(this.createOrUpdateLogFormGroup.invalid||typeof this.createOrUpdateLogFormGroup.value.exercise=="string")return;let r=this.authService.user(),o={id:a?.id,exerciseLog:{exerciseLogUsername:r?.name??this.createOrUpdateLogFormGroup.value.user.toLocaleLowerCase(),exerciseLogUserId:r?.userId,exerciseLogExerciseId:this.createOrUpdateLogFormGroup.value.exercise.exerciseId,exerciseLogDate:this.dayjsService.parseDate(this.createOrUpdateLogFormGroup.value.date).format("YYYY-MM-DD"),series:(this.createOrUpdateLogFormGroup.value.series??[]).filter(p=>!!p.reps&&!!p.weightInKg).map(p=>({exerciseLogId:p.exerciseLogId,serieId:p.serieId,reps:+p.reps,weightInKg:+p.weightInKg.toFixed(1),brzycki:null}))}};this.exerciseLogApiService.updateExerciseLog(o).subscribe({next:()=>{this.createOrUpdateLogFormGroup.reset(),this.toastService.ok("Log updated successfully!"),this.initEditMode()},error:()=>{this.toastService.error()}})}initEditMode(){this.isLoading.set(!0);let a=Number(this.route.snapshot.paramMap.get(E.LOGS_ID_PARAM));this.mode="edit",this.exerciseLogApiService.getExerciseLogById(a).subscribe(r=>{this.originalValue.set(r),this.createOrUpdateLogFormGroup.reset(),this.createOrUpdateLogFormGroup.patchValue({exercise:r.exercise,date:this.dayjsService.parseDate(r.date).format("YYYY-MM-DD"),user:r.user.name,series:r.series.map(o=>({exerciseLogId:o.exerciseLogId,serieId:o.serieId,reps:o.reps,weightInKg:o.weightInKg}))}),this.isLoading.set(!1)})}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=y({type:i,selectors:[["edit-exercise-log-page"]],standalone:!0,features:[I],decls:2,vars:1,consts:[["class","footer-padding"],[1,"footer-padding"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],[1,"modal-body"],["type","text","autofocus","autofocus",2,"display","none"],[1,"mb-3"],["type","date","placeholder","DD-MM-YYYY","placeholder","Reps",1,"form-control",3,"formControl"],[1,"input-group"],["placeholder","Exercise",3,"items","control","itemSelector"],[1,"modal-footer",3,"ngClass"],["type","button","class","btn btn-danger me-auto"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn",3,"ngClass","disabled","click"],[1,"d-block","invalid-feedback"],["class","d-block invalid-feedback"],[1,"input-group","mb-2","align-items-center"],[1,"input-group-text"],["type","number","placeholder","Reps",1,"form-control",3,"formControl"],["type","number","placeholder","Kg",1,"form-control",3,"formControl"],["type","button",1,"btn","btn-danger","me-auto",3,"click"],[1,"pt-5","w-100"],[1,"pb-2"],[1,"pt-3","w-100"],[1,"list-group","list-group-horizontal","pb-1"],[1,"list-group-item","active"],[1,"list-group-item"],[1,"w-100",3,"exerciseLog"],["class","w-100",3,"exerciseLog"],["class","list-group list-group-horizontal pb-1"],["class","input-group mb-2 align-items-center"],[1,"position-absolute","top-50","start-50","translate-middle"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"]],template:function(r,o){r&1&&x(0,Fe,23,17,"div",0)(1,Ie,4,0),r&2&&_(0,o.isLoading()?1:0)},dependencies:[re,Z,J,ee,Q,W,te,ie,X,ae,se,pe,K,$,Y],styles:["[_nghost-%COMP%]{display:block;padding:0 .5rem;--bs-heading-color: white;--bs-modal-color: white;--bs-body-bg: var(--light-bg);--bs-body-color: var(--font-color);--bs-tertiary-bg: var(--primary);--bs-border-width: 0;--bs-modal-footer-border-width: 0;--bs-modal-header-border-width: 0;--bs-modal-header-padding: .5rem}.list-group[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 3fr;--bs-list-group-bg: var(--light-bg)}.list-group[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{--bs-list-group-active-bg: var(--primary)}"],changeDetection:0});let e=i;return e})();export{et as EditExerciseLogPageComponent};
